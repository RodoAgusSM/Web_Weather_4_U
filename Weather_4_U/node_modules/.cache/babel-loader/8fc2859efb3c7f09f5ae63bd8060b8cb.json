{"ast":null,"code":"'use strict';\n\nmodule.exports = encode;\nvar keys,\n    keysNum,\n    keysArr,\n    dim,\n    e,\n    maxPrecision = 1e6;\nvar geometryTypes = {\n  'Point': 0,\n  'MultiPoint': 1,\n  'LineString': 2,\n  'MultiLineString': 3,\n  'Polygon': 4,\n  'MultiPolygon': 5,\n  'GeometryCollection': 6\n};\n\nfunction encode(obj, pbf) {\n  keys = {};\n  keysArr = [];\n  keysNum = 0;\n  dim = 0;\n  e = 1;\n  analyze(obj);\n  e = Math.min(e, maxPrecision);\n  var precision = Math.ceil(Math.log(e) / Math.LN10);\n\n  for (var i = 0; i < keysArr.length; i++) pbf.writeStringField(1, keysArr[i]);\n\n  if (dim !== 2) pbf.writeVarintField(2, dim);\n  if (precision !== 6) pbf.writeVarintField(3, precision);\n  if (obj.type === 'FeatureCollection') pbf.writeMessage(4, writeFeatureCollection, obj);else if (obj.type === 'Feature') pbf.writeMessage(5, writeFeature, obj);else pbf.writeMessage(6, writeGeometry, obj);\n  keys = null;\n  return pbf.finish();\n}\n\nfunction analyze(obj) {\n  var i, key;\n\n  if (obj.type === 'FeatureCollection') {\n    for (i = 0; i < obj.features.length; i++) analyze(obj.features[i]);\n  } else if (obj.type === 'Feature') {\n    if (obj.geometry !== null) analyze(obj.geometry);\n\n    for (key in obj.properties) saveKey(key);\n  } else if (obj.type === 'Point') analyzePoint(obj.coordinates);else if (obj.type === 'MultiPoint') analyzePoints(obj.coordinates);else if (obj.type === 'GeometryCollection') {\n    for (i = 0; i < obj.geometries.length; i++) analyze(obj.geometries[i]);\n  } else if (obj.type === 'LineString') analyzePoints(obj.coordinates);else if (obj.type === 'Polygon' || obj.type === 'MultiLineString') analyzeMultiLine(obj.coordinates);else if (obj.type === 'MultiPolygon') {\n    for (i = 0; i < obj.coordinates.length; i++) analyzeMultiLine(obj.coordinates[i]);\n  }\n\n  for (key in obj) {\n    if (!isSpecialKey(key, obj.type)) saveKey(key);\n  }\n}\n\nfunction analyzeMultiLine(coords) {\n  for (var i = 0; i < coords.length; i++) analyzePoints(coords[i]);\n}\n\nfunction analyzePoints(coords) {\n  for (var i = 0; i < coords.length; i++) analyzePoint(coords[i]);\n}\n\nfunction analyzePoint(point) {\n  dim = Math.max(dim, point.length); // find max precision\n\n  for (var i = 0; i < point.length; i++) {\n    while (Math.round(point[i] * e) / e !== point[i] && e < maxPrecision) e *= 10;\n  }\n}\n\nfunction saveKey(key) {\n  if (keys[key] === undefined) {\n    keysArr.push(key);\n    keys[key] = keysNum++;\n  }\n}\n\nfunction writeFeatureCollection(obj, pbf) {\n  for (var i = 0; i < obj.features.length; i++) {\n    pbf.writeMessage(1, writeFeature, obj.features[i]);\n  }\n\n  writeProps(obj, pbf, true);\n}\n\nfunction writeFeature(feature, pbf) {\n  if (feature.geometry !== null) pbf.writeMessage(1, writeGeometry, feature.geometry);\n\n  if (feature.id !== undefined) {\n    if (typeof feature.id === 'number' && feature.id % 1 === 0) pbf.writeSVarintField(12, feature.id);else pbf.writeStringField(11, feature.id);\n  }\n\n  if (feature.properties) writeProps(feature.properties, pbf);\n  writeProps(feature, pbf, true);\n}\n\nfunction writeGeometry(geom, pbf) {\n  pbf.writeVarintField(1, geometryTypes[geom.type]);\n  var coords = geom.coordinates;\n  if (geom.type === 'Point') writePoint(coords, pbf);else if (geom.type === 'MultiPoint') writeLine(coords, pbf, true);else if (geom.type === 'LineString') writeLine(coords, pbf);else if (geom.type === 'MultiLineString') writeMultiLine(coords, pbf);else if (geom.type === 'Polygon') writeMultiLine(coords, pbf, true);else if (geom.type === 'MultiPolygon') writeMultiPolygon(coords, pbf);else if (geom.type === 'GeometryCollection') {\n    for (var i = 0; i < geom.geometries.length; i++) pbf.writeMessage(4, writeGeometry, geom.geometries[i]);\n  }\n  writeProps(geom, pbf, true);\n}\n\nfunction writeProps(props, pbf, isCustom) {\n  var indexes = [],\n      valueIndex = 0;\n\n  for (var key in props) {\n    if (isCustom && isSpecialKey(key, props.type)) {\n      continue;\n    }\n\n    pbf.writeMessage(13, writeValue, props[key]);\n    indexes.push(keys[key]);\n    indexes.push(valueIndex++);\n  }\n\n  pbf.writePackedVarint(isCustom ? 15 : 14, indexes);\n}\n\nfunction writeValue(value, pbf) {\n  if (value === null) return;\n  var type = typeof value;\n  if (type === 'string') pbf.writeStringField(1, value);else if (type === 'boolean') pbf.writeBooleanField(5, value);else if (type === 'object') pbf.writeStringField(6, JSON.stringify(value));else if (type === 'number') {\n    if (value % 1 !== 0) pbf.writeDoubleField(2, value);else if (value >= 0) pbf.writeVarintField(3, value);else pbf.writeVarintField(4, -value);\n  }\n}\n\nfunction writePoint(point, pbf) {\n  var coords = [];\n\n  for (var i = 0; i < dim; i++) coords.push(Math.round(point[i] * e));\n\n  pbf.writePackedSVarint(3, coords);\n}\n\nfunction writeLine(line, pbf) {\n  var coords = [];\n  populateLine(coords, line);\n  pbf.writePackedSVarint(3, coords);\n}\n\nfunction writeMultiLine(lines, pbf, closed) {\n  var len = lines.length,\n      i;\n\n  if (len !== 1) {\n    var lengths = [];\n\n    for (i = 0; i < len; i++) lengths.push(lines[i].length - (closed ? 1 : 0));\n\n    pbf.writePackedVarint(2, lengths); // TODO faster with custom writeMessage?\n  }\n\n  var coords = [];\n\n  for (i = 0; i < len; i++) populateLine(coords, lines[i], closed);\n\n  pbf.writePackedSVarint(3, coords);\n}\n\nfunction writeMultiPolygon(polygons, pbf) {\n  var len = polygons.length,\n      i,\n      j;\n\n  if (len !== 1 || polygons[0].length !== 1) {\n    var lengths = [len];\n\n    for (i = 0; i < len; i++) {\n      lengths.push(polygons[i].length);\n\n      for (j = 0; j < polygons[i].length; j++) lengths.push(polygons[i][j].length - 1);\n    }\n\n    pbf.writePackedVarint(2, lengths);\n  }\n\n  var coords = [];\n\n  for (i = 0; i < len; i++) {\n    for (j = 0; j < polygons[i].length; j++) populateLine(coords, polygons[i][j], true);\n  }\n\n  pbf.writePackedSVarint(3, coords);\n}\n\nfunction populateLine(coords, line, closed) {\n  var i,\n      j,\n      len = line.length - (closed ? 1 : 0),\n      sum = new Array(dim);\n\n  for (j = 0; j < dim; j++) sum[j] = 0;\n\n  for (i = 0; i < len; i++) {\n    for (j = 0; j < dim; j++) {\n      var n = Math.round(line[i][j] * e) - sum[j];\n      coords.push(n);\n      sum[j] += n;\n    }\n  }\n}\n\nfunction isSpecialKey(key, type) {\n  if (key === 'type') return true;else if (type === 'FeatureCollection') {\n    if (key === 'features') return true;\n  } else if (type === 'Feature') {\n    if (key === 'id' || key === 'properties' || key === 'geometry') return true;\n  } else if (type === 'GeometryCollection') {\n    if (key === 'geometries') return true;\n  } else if (key === 'coordinates') return true;\n  return false;\n}","map":{"version":3,"names":["module","exports","encode","keys","keysNum","keysArr","dim","e","maxPrecision","geometryTypes","obj","pbf","analyze","Math","min","precision","ceil","log","LN10","i","length","writeStringField","writeVarintField","type","writeMessage","writeFeatureCollection","writeFeature","writeGeometry","finish","key","features","geometry","properties","saveKey","analyzePoint","coordinates","analyzePoints","geometries","analyzeMultiLine","isSpecialKey","coords","point","max","round","undefined","push","writeProps","feature","id","writeSVarintField","geom","writePoint","writeLine","writeMultiLine","writeMultiPolygon","props","isCustom","indexes","valueIndex","writeValue","writePackedVarint","value","writeBooleanField","JSON","stringify","writeDoubleField","writePackedSVarint","line","populateLine","lines","closed","len","lengths","polygons","j","sum","Array","n"],"sources":["/Users/rodoagus/node_modules/geobuf/encode.js"],"sourcesContent":["'use strict';\n\nmodule.exports = encode;\n\nvar keys, keysNum, keysArr, dim, e,\n    maxPrecision = 1e6;\n\nvar geometryTypes = {\n    'Point': 0,\n    'MultiPoint': 1,\n    'LineString': 2,\n    'MultiLineString': 3,\n    'Polygon': 4,\n    'MultiPolygon': 5,\n    'GeometryCollection': 6\n};\n\nfunction encode(obj, pbf) {\n    keys = {};\n    keysArr = [];\n    keysNum = 0;\n    dim = 0;\n    e = 1;\n\n    analyze(obj);\n\n    e = Math.min(e, maxPrecision);\n    var precision = Math.ceil(Math.log(e) / Math.LN10);\n\n    for (var i = 0; i < keysArr.length; i++) pbf.writeStringField(1, keysArr[i]);\n    if (dim !== 2) pbf.writeVarintField(2, dim);\n    if (precision !== 6) pbf.writeVarintField(3, precision);\n\n    if (obj.type === 'FeatureCollection') pbf.writeMessage(4, writeFeatureCollection, obj);\n    else if (obj.type === 'Feature') pbf.writeMessage(5, writeFeature, obj);\n    else pbf.writeMessage(6, writeGeometry, obj);\n\n    keys = null;\n\n    return pbf.finish();\n}\n\nfunction analyze(obj) {\n    var i, key;\n\n    if (obj.type === 'FeatureCollection') {\n        for (i = 0; i < obj.features.length; i++) analyze(obj.features[i]);\n\n    } else if (obj.type === 'Feature') {\n        if (obj.geometry !== null) analyze(obj.geometry);\n        for (key in obj.properties) saveKey(key);\n\n    } else if (obj.type === 'Point') analyzePoint(obj.coordinates);\n    else if (obj.type === 'MultiPoint') analyzePoints(obj.coordinates);\n    else if (obj.type === 'GeometryCollection') {\n        for (i = 0; i < obj.geometries.length; i++) analyze(obj.geometries[i]);\n    }\n    else if (obj.type === 'LineString') analyzePoints(obj.coordinates);\n    else if (obj.type === 'Polygon' || obj.type === 'MultiLineString') analyzeMultiLine(obj.coordinates);\n    else if (obj.type === 'MultiPolygon') {\n        for (i = 0; i < obj.coordinates.length; i++) analyzeMultiLine(obj.coordinates[i]);\n    }\n\n    for (key in obj) {\n        if (!isSpecialKey(key, obj.type)) saveKey(key);\n    }\n}\n\nfunction analyzeMultiLine(coords) {\n    for (var i = 0; i < coords.length; i++) analyzePoints(coords[i]);\n}\n\nfunction analyzePoints(coords) {\n    for (var i = 0; i < coords.length; i++) analyzePoint(coords[i]);\n}\n\nfunction analyzePoint(point) {\n    dim = Math.max(dim, point.length);\n\n    // find max precision\n    for (var i = 0; i < point.length; i++) {\n        while (Math.round(point[i] * e) / e !== point[i] && e < maxPrecision) e *= 10;\n    }\n}\n\nfunction saveKey(key) {\n    if (keys[key] === undefined) {\n        keysArr.push(key);\n        keys[key] = keysNum++;\n    }\n}\n\nfunction writeFeatureCollection(obj, pbf) {\n    for (var i = 0; i < obj.features.length; i++) {\n        pbf.writeMessage(1, writeFeature, obj.features[i]);\n    }\n    writeProps(obj, pbf, true);\n}\n\nfunction writeFeature(feature, pbf) {\n    if (feature.geometry !== null) pbf.writeMessage(1, writeGeometry, feature.geometry);\n\n    if (feature.id !== undefined) {\n        if (typeof feature.id === 'number' && feature.id % 1 === 0) pbf.writeSVarintField(12, feature.id);\n        else pbf.writeStringField(11, feature.id);\n    }\n\n    if (feature.properties) writeProps(feature.properties, pbf);\n    writeProps(feature, pbf, true);\n}\n\nfunction writeGeometry(geom, pbf) {\n    pbf.writeVarintField(1, geometryTypes[geom.type]);\n\n    var coords = geom.coordinates;\n\n    if (geom.type === 'Point') writePoint(coords, pbf);\n    else if (geom.type === 'MultiPoint') writeLine(coords, pbf, true);\n    else if (geom.type === 'LineString') writeLine(coords, pbf);\n    else if (geom.type === 'MultiLineString') writeMultiLine(coords, pbf);\n    else if (geom.type === 'Polygon') writeMultiLine(coords, pbf, true);\n    else if (geom.type === 'MultiPolygon') writeMultiPolygon(coords, pbf);\n    else if (geom.type === 'GeometryCollection') {\n        for (var i = 0; i < geom.geometries.length; i++) pbf.writeMessage(4, writeGeometry, geom.geometries[i]);\n    }\n\n    writeProps(geom, pbf, true);\n}\n\nfunction writeProps(props, pbf, isCustom) {\n    var indexes = [],\n        valueIndex = 0;\n\n    for (var key in props) {\n        if (isCustom && isSpecialKey(key, props.type)) {\n            continue;\n        }\n        pbf.writeMessage(13, writeValue, props[key]);\n        indexes.push(keys[key]);\n        indexes.push(valueIndex++);\n    }\n    pbf.writePackedVarint(isCustom ? 15 : 14, indexes);\n}\n\nfunction writeValue(value, pbf) {\n    if (value === null) return;\n\n    var type = typeof value;\n\n    if (type === 'string') pbf.writeStringField(1, value);\n    else if (type === 'boolean') pbf.writeBooleanField(5, value);\n    else if (type === 'object') pbf.writeStringField(6, JSON.stringify(value));\n    else if (type === 'number') {\n        if (value % 1 !== 0) pbf.writeDoubleField(2, value);\n        else if (value >= 0) pbf.writeVarintField(3, value);\n        else pbf.writeVarintField(4, -value);\n    }\n}\n\nfunction writePoint(point, pbf) {\n    var coords = [];\n    for (var i = 0; i < dim; i++) coords.push(Math.round(point[i] * e));\n    pbf.writePackedSVarint(3, coords);\n}\n\nfunction writeLine(line, pbf) {\n    var coords = [];\n    populateLine(coords, line);\n    pbf.writePackedSVarint(3, coords);\n}\n\nfunction writeMultiLine(lines, pbf, closed) {\n    var len = lines.length,\n        i;\n    if (len !== 1) {\n        var lengths = [];\n        for (i = 0; i < len; i++) lengths.push(lines[i].length - (closed ? 1 : 0));\n        pbf.writePackedVarint(2, lengths);\n        // TODO faster with custom writeMessage?\n    }\n    var coords = [];\n    for (i = 0; i < len; i++) populateLine(coords, lines[i], closed);\n    pbf.writePackedSVarint(3, coords);\n}\n\nfunction writeMultiPolygon(polygons, pbf) {\n    var len = polygons.length,\n        i, j;\n    if (len !== 1 || polygons[0].length !== 1) {\n        var lengths = [len];\n        for (i = 0; i < len; i++) {\n            lengths.push(polygons[i].length);\n            for (j = 0; j < polygons[i].length; j++) lengths.push(polygons[i][j].length - 1);\n        }\n        pbf.writePackedVarint(2, lengths);\n    }\n\n    var coords = [];\n    for (i = 0; i < len; i++) {\n        for (j = 0; j < polygons[i].length; j++) populateLine(coords, polygons[i][j], true);\n    }\n    pbf.writePackedSVarint(3, coords);\n}\n\nfunction populateLine(coords, line, closed) {\n    var i, j,\n        len = line.length - (closed ? 1 : 0),\n        sum = new Array(dim);\n    for (j = 0; j < dim; j++) sum[j] = 0;\n    for (i = 0; i < len; i++) {\n        for (j = 0; j < dim; j++) {\n            var n = Math.round(line[i][j] * e) - sum[j];\n            coords.push(n);\n            sum[j] += n;\n        }\n    }\n}\n\nfunction isSpecialKey(key, type) {\n    if (key === 'type') return true;\n    else if (type === 'FeatureCollection') {\n        if (key === 'features') return true;\n    } else if (type === 'Feature') {\n        if (key === 'id' || key === 'properties' || key === 'geometry') return true;\n    } else if (type === 'GeometryCollection') {\n        if (key === 'geometries') return true;\n    } else if (key === 'coordinates') return true;\n    return false;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}